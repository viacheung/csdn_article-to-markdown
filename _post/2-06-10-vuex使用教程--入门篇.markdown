---
layout:  post
title:   vuexä½¿ç”¨æ•™ç¨‹--å…¥é—¨ç¯‡
date:   2-06-10 17:32:16 å‘å¸ƒ
author:  'zhangtao'
header-img: 'img/post-bg-2015.jpg'
catalog:   false
tags:
-å‰ç«¯

---




æŒ‰ç…§å®˜ç½‘çš„è¯´æ³•ï¼ŒVuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚

## vuexçš„ç»„æˆ

vuexç”±äº”ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯Stateï¼ŒMutationï¼ŒActionï¼ŒModuleï¼ŒGetterã€‚


## ä¸ºä»€ä¹ˆä½¿ç”¨vuexï¼Ÿ

-  å¤šä¸ªè§†å›¾ä¾èµ–äºåŒä¸€çŠ¶æ€  
-  æ¥è‡ªä¸åŒè§†å›¾çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€çŠ¶æ€ 

å¯¹äºé—®é¢˜ä¸€ï¼Œä¼ å‚çš„æ–¹æ³•å¯¹äºå¤šå±‚åµŒå¥—çš„ç»„ä»¶å°†ä¼šéå¸¸ç¹çï¼Œå¹¶ä¸”å¯¹äºå…„å¼Ÿç»„ä»¶é—´çš„çŠ¶æ€ä¼ é€’æ— èƒ½ä¸ºåŠ›ã€‚

å¯¹äºé—®é¢˜äºŒï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡‡ç”¨çˆ¶å­ç»„ä»¶ç›´æ¥å¼•ç”¨æˆ–è€…é€šè¿‡äº‹ä»¶æ¥å˜æ›´å’ŒåŒæ­¥çŠ¶æ€çš„å¤šä»½æ‹·è´ã€‚ä»¥ä¸Šçš„è¿™äº›æ¨¡å¼éå¸¸è„†å¼±ï¼Œé€šå¸¸ä¼šå¯¼è‡´æ— æ³•ç»´æŠ¤çš„ä»£ç ã€‚

å…¶å®vuexé€šä¿—ç‚¹å¯ä»¥ç†è§£ä¸º**å“åº”å¼çš„å…¨å±€å˜é‡**ï¼Œä½œç”¨ä¹Ÿä¸æˆ‘ä»¬åœ¨Cè¯­è¨€ï¼ŒC++ï¼ŒJavaä¸­çš„å…¨å±€å˜é‡ï¼ˆé™æ€å˜é‡ï¼‰æœ‰ç±»ä¼¼ä¹‹å¤„ã€‚

## ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ vuexï¼Ÿ

Vuex å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†å…±äº«çŠ¶æ€ï¼Œå¹¶é™„å¸¦äº†æ›´å¤šçš„æ¦‚å¿µå’Œæ¡†æ¶ã€‚è¿™éœ€è¦å¯¹çŸ­æœŸå’Œé•¿æœŸæ•ˆç›Šè¿›è¡Œæƒè¡¡ã€‚å¦‚æœæ‚¨ä¸æ‰“ç®—å¼€å‘å¤§å‹å•é¡µåº”ç”¨ï¼Œä½¿ç”¨ Vuex å¯èƒ½æ˜¯ç¹çå†—ä½™çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨éœ€è¦æ„å»ºä¸€ä¸ªä¸­å¤§å‹å•é¡µåº”ç”¨ï¼Œæ‚¨å¾ˆå¯èƒ½ä¼šè€ƒè™‘å¦‚ä½•æ›´å¥½åœ°åœ¨ç»„ä»¶å¤–éƒ¨ç®¡ç†çŠ¶æ€ï¼ŒVuex å°†ä¼šæˆä¸ºè‡ªç„¶è€Œç„¶çš„é€‰æ‹©ã€‚

## vuexå®‰è£…ï¼ˆéœ€å…ˆå®‰è£…vue-cliï¼‰

1.cdåˆ°è‡ªå·±çš„é¡¹ç›®ç›®å½•ä¸‹

2.è¾“å…¥å‘½ä»¤ï¼š**npm install vuex --save**

å¦‚æœå‡ºç°ä»¥ä¸‹æç¤ºï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸ


![img](https://img-blog.csdnimg.cn/img_convert/c498bd43c39e90f5a85e7c1943e8df45.png)

å¦‚æœå‡ºç°ä»¥ä¸‹æç¤ºï¼Œåˆ™éœ€åˆ‡æ¢åˆ°ç®¡**ç†å‘˜æ¨¡å¼ä¸‹çš„å‘½ä»¤è¡Œ**ï¼Œå†æ‰§è¡Œcdå’Œå®‰è£…æ“ä½œ


![img](https://img-blog.csdnimg.cn/img_convert/14c0b236dfcb1a0c5f281c8b68dac91b.png)

## vueçš„ä½¿ç”¨

å¯èƒ½è¯´åˆ°è¿™é‡Œè¿˜æœ‰å¾ˆå¤šäººè¿˜æ˜¯ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆè¦ä½¿ç”¨vuexï¼Œè™½ç„¶åˆšåˆšå·²ç»è§£é‡Šè¿‡äº†ã€‚

ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾è¦ç»Ÿè®¡ä¸¤ä¸ªé¡µé¢çš„æ‰€æœ‰æŒ‰é’®ç‚¹å‡»æ€»æ¬¡æ•°ã€‚æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªcountæ¥ä»£è¡¨å®ƒã€‚å½“ç”¨æˆ·ä»page1è·³è½¬åˆ°page2çš„æ—¶å€™ï¼Œå¦‚ä½•çŸ¥é“ç”¨æˆ·åœ¨page1ä¸­ç‚¹å‡»äº†å¤šå°‘ä¸‹å‘¢ï¼Ÿåœ¨æ²¡æœ‰ä½¿ç”¨vuexçš„æ—¶å€™æˆ‘ä»¬é€šå¸¸æ˜¯ä½¿ç”¨ç»„ä»¶æˆ–è·¯ç”±ä¼ å‚æ¥ä¼ é€’countä»¥è¾¾åˆ°ç»Ÿè®¡çš„ç›®çš„ã€‚å½“page1è·³è½¬åˆ°page2æ—¶ï¼Œä¼ é€’countåˆ°page2ï¼Œåä¹‹äº¦ç„¶ã€‚å½“åªæœ‰ä¸¤ä¸ªç•Œé¢çš„æ—¶å€™ï¼Œè¿™ç§åšæ³•å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚å¦‚æœæœ‰è¦ç»Ÿè®¡åä¸ªç•Œé¢çš„æ‰€æœ‰æŒ‰é’®ç‚¹å‡»æ€»æ¬¡æ•°å‘¢ï¼Ÿè¿™å°†æ˜¯ä¸€ä¸ªå·¨å¤§çš„éº»çƒ¦ã€‚æ‰€ä»¥ä¸‹é¢ä¹Ÿä»¥è¿™ä¸ªä¾‹å­æ¥å­¦ä¹ ä¸€ä¸‹vuexã€‚

### 1.é¦–å…ˆï¼Œæ–°å»ºå¥½æ‰€éœ€æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼Œä»¥ä¾›ç­‰ä¸‹çš„å­¦ä¹ ä½¿ç”¨ã€‚

åœ¨srcç›®å½•ä¸‹æ–°å»ºstoreå’Œpagesæ–‡ä»¶å¤¹ï¼Œstoreæ–‡ä»¶å¤¹é‡Œé¢æ–°å»ºäº”ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯store.jsï¼Œstate.jsï¼Œactions.jsï¼Œmutations.jsï¼Œgetters.jsã€‚pagesæ–‡ä»¶å¤¹é‡Œé¢æ–°å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯page1.vueï¼Œpage2.vueã€‚


![img](https://img-blog.csdnimg.cn/img_convert/9c4262c2325297612592b16d1a6293f6.png)

### 2.ç„¶åè¿›è¡Œé…ç½®

#### ï¼ˆ1ï¼‰åœ¨main.jså¼•å…¥ã€æ³¨å†Œstore


![img](https://img-blog.csdnimg.cn/img_convert/55522d936c4343f5672c3cfba5167e6c.png)

#### ï¼ˆ2ï¼‰åœ¨index.jsä¸­æ·»åŠ è·¯ç”±

```java
import Vue from 'vue'
import Router from 'vue-router'
import page1 from '../pages/page1'
import page2 from '../pages/page2'

Vue.use(Router)

export default new Router({
  routes: [
    {
      path: '/',
      name: 'page1',
      component: page1
    },
    {
      path: '/page1',
      name: 'page1',
      component: page1
    },
    {
      path: '/page2',
      name: 'page2',
      component: page2
    }
  ]
})
```

#### ï¼ˆ3ï¼‰åœ¨store.jsä¸­æ·»åŠ 

```java
import Vue from 'vue'
import Vuex from 'vuex'
import state from './state'
import mutations from './mutations'
import actions from './actions'
import getters from './getters'

Vue.use(Vuex)

export default new Vuex.Store({
    state,
    mutations,
    actions,
    getters,
})
```


[![img](https://img-blog.csdnimg.cn/img_convert/7dd9ccd4e6f7fd911eb1ffa20eeea640.gif)](javascript:void(0)ğŸ˜‰

### 3.å®Œæˆä»¥ä¸Šæ­¥éª¤å°±å¯ä»¥åˆæ­¥ä½¿ç”¨vuexäº†

#### ï¼ˆ1ï¼‰state

åœ¨state.jsæ·»åŠ çŠ¶æ€å˜é‡countï¼Œå¹¶è®¾ç½®åˆå€¼ä¸º0

```java
export default {
    count:'0'
}
```

é€šè¿‡"this.$store.state.å˜é‡å"å¯ä»¥è®¿é—®è®¿é—®çŠ¶æ€å˜é‡ã€‚åœ¨page1ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œå°±å¯ä»¥æ˜¾ç¤ºä¸ºcountèµ‹çš„åˆå€¼

```java
<template>
    <div>æ€»æ•°æ˜¯ï¼š{
  {this.$store.state.count}}</div>
</template>

<script>
export default {

}
</script>
```


![img](https://img-blog.csdnimg.cn/img_convert/867edc94bd43edb7a59b4e595b541b69.png)

å½“ç„¶ï¼Œå¦‚æœè¿™ä¸ªå˜é‡åœ¨è¿™ä¸ªé¡µé¢åªå‡ºç°ä¸€æ¬¡ä½ å¯ä»¥è¿™ä¹ˆå†™ï¼Œä½†æ˜¯å¦‚æœç»å¸¸å‡ºç°ä½ æ¯æ¬¡éƒ½ä½¿ç”¨"this.$store.state.å˜é‡å"å°†æ˜¯ä¸€ä»¶éº»çƒ¦çš„äº‹æƒ…ã€‚

ä¸€ç§æ›´ç®€ä¾¿çš„æ–¹æ³•æ˜¯ä½¿ç”¨è®¡ç®—å±æ€§è¿”å›countçš„å€¼

```java
<template>
   æ€»æ•°æ˜¯ï¼š{
  {getCount}}
  </div>
</template>
<script>
export default {

  computed: {
â€‹    getCount:function() {
â€‹      return this.$store.state.count
â€‹    }
  }
}

</script>
```

æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨mapStateæ¥æ˜ å°„stateä¸­çš„çŠ¶æ€å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨count

```java
<template>
    <div>
        æ€»æ•°æ˜¯ï¼š{
  {count}}
    </div>
</template>

<script>
```

import {mapState,mapMutations,mapActions,mapGetters} from â€˜vuexâ€™; //å¯¼å…¥mapStateæ–¹æ³•ï¼ŒåŒæ—¶å¯¼å…¥å…¶ä»–æ–¹æ³•çš„ï¼Œæ–¹ä¾¿ç­‰ä¸‹ä½¿ç”¨

```java
export default {
    //æ˜ å°„count,this.countå°±æ˜¯this.$store.state.count,ç›¸å½“äºæŠŠstateä¸­çš„countå˜ä¸ºç»„ä»¶çš„å˜é‡
    computed: mapState(["count"]) 
}
</script>
```

#### ï¼ˆ2ï¼‰mutation

ä¹‹å‰è¯´è¿‡ï¼Œåªæœ‰é€šè¿‡mutationæ‰èƒ½æ›´æ”¹stateä¸­å˜é‡çš„å€¼ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨mutations.jsä¸­æ·»åŠ ä¿®æ”¹stateä¸­countçš„æ–¹æ³•ç”¨äºå®ç°ç‚¹å‡»æ¬¡æ•°ç»Ÿè®¡ï¼Œå¦‚ä¸‹

```java
export default {
     addCount(state) {  //ä¼ å…¥stateå¯¹è±¡
ã€€ã€€ã€€state.count++ 
    }
}
```

å¦‚æœè¦å®ç°ç»Ÿè®¡ç‚¹å‡»æ¬¡æ•°ï¼Œå°±æ˜¯å½“æ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™è°ƒç”¨mutationä¸­çš„addCountæ–¹æ³•ã€‚é€šè¿‡"this.$store.commit(â€œaddCountâ€)"å¯ä»¥è°ƒç”¨addCountæ–¹æ³•å®ç°countçš„å¢åŠ ï¼Œå¦‚ä¸‹

```java
<template>
    <div>
        <button @click="addCount()">ç‚¹å‡»æ€»æ•°æ˜¯ï¼š{
  {count}}</button>
    </div>
</template>

<script>
import {mapState} from 'vuex';
export default {
    //æ˜ å°„count,this.countå°±æ˜¯this.$store.state.count,ç›¸å½“äºæŠŠstateä¸­çš„countå˜ä¸ºç»„ä»¶çš„å˜é‡
    computed: mapState(["count"]),
    methods: {
        addCount() { 
            this.$store.commit("addCount")
        }
    }
}
</script>
```

åŒæ ·çš„ï¼Œé€šè¿‡mapMutationæ¥æ˜ å°„ä¹Ÿå¯ä»¥ä½¿ç”¨addCountæ–¹æ³•

```java
methods: {
        ...mapMutations(["addCount"])  //æ˜ å°„addCountæ–¹æ³•,this.addCountå°±ç­‰äºthis.$store.commit("addCount")
    }
```

#### ï¼ˆ3ï¼‰getters

getterså¯ä»¥ç†è§£ä¸ºstoreä¸­çš„è®¡ç®—å±æ€§ï¼Œå¯¹stateä¸­çš„å˜é‡åœ¨è¾“å‡ºå‰è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼šéœ€è¦å®ç°å†ç‚¹å‡»ä¸‰ä¸‹æŒ‰é’®ä¹‹åä¸€å…±ç‚¹å‡»äº†å¤šå°‘ä¸‹æ¬¡æ•°æ˜¾ç¤ºçš„åŠŸèƒ½ï¼Œå°±å¯ä»¥åœ¨getters,jsæ·»åŠ ä»¥ä¸‹ä»£ç 

```java
export default {
    getCountAfter3(state) {  //ä¼ å…¥stateå¯¹è±¡
        let result = state.count+3
        return result
    }
}
```

ç„¶ååœ¨page1ä¸­ï¼Œé€šè¿‡"this.$store.getters.getCountAfter3"è°ƒç”¨getCountAfter3æ–¹æ³•æ˜¾ç¤ºï¼Œå¯ä»¥å®ç°ä¸Šè¿°æ•ˆæœ

```java
<button>ç»§ç»­ç‚¹å‡»ä¸‰æ¬¡åæ¬¡æ•°å°†ä¼šå˜ä¸º{
  {getCountAfter3}}</button>
```


![img](https://img-blog.csdnimg.cn/img_convert/1b4367bbf72b8e49893dedc2e6b1c7e4.png)

åŒæ ·çš„ï¼Œé€šè¿‡æ˜ å°„ä¹Ÿå¯ä»¥ä½¿ç”¨gettersä¸­çš„æ–¹æ³•

```java
computed: {
        ...mapState(["count"]),  //æ˜ å°„count,this.countå°±æ˜¯this.$store.state.count,ç›¸å½“äºæŠŠstateä¸­çš„countå˜ä¸ºç»„ä»¶çš„å˜é‡
        ...mapGetters(["getCountAfter3"]),  //æ˜ å°„getCountAfter3
    },
```

#### ï¼ˆ4ï¼‰actions

é€šè¿‡actionä¹Ÿå¯ä»¥å®ç°countçš„å¢åŠ ã€‚å½“ç„¶ï¼Œactionä¹Ÿæ˜¯é€šè¿‡è°ƒç”¨mutationæ¥å®ç°countå¢åŠ çš„ã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯actionså¯ä»¥å®ç°å¼‚æ­¥æ“ä½œã€‚åœ¨actions.jsæ·»åŠ 

```java
export default {
    addCountAction({commit}) {
        commit('addCount')
    }
}
```

ç„¶ååœ¨page1ä¸­å¯ä»¥é€šè¿‡"this.$store.dispatch(â€˜addCountActionâ€™)"æ¥è°ƒç”¨addCountActionæ–¹æ³•å®ç°count++ï¼ˆä¸Mutationsç±»ä¼¼ï¼‰

åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ˜ å°„æ¥ä½¿ç”¨addCountActionæ–¹æ³•

```java
methods: {
        ...mapMutations(["addCount"]),  //æ˜ å°„addCountæ–¹æ³•,this.addCountå°±ç­‰äºthis.$store.commit("addCount")
        ...mapActions(["addCountAction"])  //æ˜ å°„addCountActionæ–¹æ³•
    }
```

å› ä¸ºç¯‡å¹…é™åˆ¶ï¼Œpage2å°±ä¸å†è¯¦ç»†è®²è¿°ï¼Œpage2é¡µé¢å…¶å®å¯ä»¥ç›´æ¥å¤åˆ¶page1ï¼Œå†åœ¨ä¸¤ä¸ªç•Œé¢æ·»åŠ è·³è½¬æŒ‰é’®å³å¯ï¼Œå®ç°æ•ˆæœå¦‚ä¸‹ï¼š


![img](https://img-blog.csdnimg.cn/img_convert/4cffb7350069cfe17f59d77fd8d06947.gif)

